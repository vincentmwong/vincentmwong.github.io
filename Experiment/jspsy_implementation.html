<!DOCTYPE html>
<html>

    <!--###########################################
	 # HEADER, IMPORT SCRIPTS
	 ############################################-->
    
    <head>
	
	<title>Social Network Study</title>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>

	<link href="jspsych-6.0.4/css/jspsych.css" rel="stylesheet" type="text/css"></link>
	<link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">

	<script src="jspsych-6.0.4/jspsych.js"></script>
	<script src="jspsych-6.0.4/plugins/jspsych-html-keyboard-response.js"></script>
	<script src="jspsych-6.0.4/plugins/jspsych-html-button-response.js"></script>
	<script src="jspsych-6.0.4/plugins/jspsych-survey-likert.js"></script>
	<script src="jspsych-6.0.4/plugins/jspsych-survey-text.js"></script>
	<script src="jspsych-6.0.4/plugins/jspsych-survey-multi-choice.js"></script>
	<script src="jspsych-6.0.4/plugins/jspsych-instructions.js"></script>
	<script src="jspsych-6.0.4/plugins/jspsych-scosn-interface.js"></script>
	<script src="networks/friendslist_0.js"></script>

	<meta name="viewport" content="width=device-width, initial-scale=1">
	<style>
	 /* width */
	 ::-webkit-scrollbar {
	     width: 10px;
	 }

	 /* Track */
	 ::-webkit-scrollbar-track {
	     background: #f9f9f9; 
	 }
	 
	 /* Handle */
	 ::-webkit-scrollbar-thumb {
	     background: #bec1c6; 
	 }

	 /* Handle on hover */
	 ::-webkit-scrollbar-thumb:hover {
	     background: #999; 
	 }

	 .button {
	     background-color: #4CAF50; /* Green */
	     border: none;
	     color: white;
	     padding: 15px 32px;
	     text-align: center;
	     text-decoration: none;
	     display: inline-block;
	     font-size: 16px;
	 }
	</style>
    </head>


    <!--###########################################
	 # BODY, WHERE THE DIVS LIVE
	 ############################################-->

    <body>
	<div id="consent" style="margin-left:100px;margin-right:100px;">
  	    <p class="lead_right">IRB Study #0804000155 (97-763)</p>
  	    <h1>INDIANA UNIVERSITY INFORMED CONSENT FOR</h1>
  	    <h2>Concepts and Percepts</h2>
  	    <p>You are invited to participate in a research study of how what we have learned can influence how people think, act, and make decisions.  You were selected as a possible subject because you contacted our research team expressing interest in participating.  We ask that you read this form and ask any questions you may have before agreeing to be in the study.</p>
  	    <p>The study is being conducted by Dr. Robert Goldstone in the Department of Psychological and Brain Sciences.</p>
  	    <h3>STUDY PURPOSE</h3>
  	    <p>The purpose of this study is to better understand the ways that people see objects can change as they learn new tasks.</p>
  	    <h3>NUMBER OF PEOPLE TAKING PART IN THE STUDY:</h3>
  	    <p>If you agree to participate, you will be one of approximately 15000 subjects who will be participating in this research.</p>
  	    <h3>PROCEDURES FOR THE STUDY:</h3>
  	    <p>If you agree to be in the study, you will be presented with several straightforward tasks to complete.  These tasks will include responding with key strokes to images displayed on a computer monitor and may involve learning what categories objects belong in, determining if objects are identical or related, and transferring what you learn about objects in one training task to a related task.</p>
  	    <p>The entire session should take a maximum of 30 minutes. You may only participate in the experiment once.</p>
  	    <h3>RISKS OF TAKING PART IN THE STUDY:</h3>
  	    <p>Participation in this study involves a potential risk of loss of confidentiality. </p>
  	    <h3>BENEFITS OF TAKING PART IN THE STUDY:</h3>
  	    <p>An understanding of how people change the way they see the world as they learn can help us to find more efficient methods to teach information and develop technologies that increase the speed of learning. You benefit from this experience because you learn something about how an experiment is designed and conducted, what issues are of interest to cognitive scientists, and what kinds of group behaviors emerge when individuals try to reach their goals in an environment that consists largely of other individuals.</p>
  	    <h3>ALTERNATIVES TO TAKING PART IN THE STUDY:</h3>
  	    <p>An alternative to participating in the study is to choose not to participate.</p>
  	    <h3>CONFIDENTIALITY</h3>
  	    <p>Efforts will be made to keep your personal information confidential.  We cannot guarantee absolute confidentiality.  Your personal information may be disclosed if required by law. Your identity will be held in confidence in reports in which the study may be published and in databases in which results may be stored.  Organizations that may inspect and/or copy your research records for quality assurance and data analysis include groups such as the study investigator and his/her research associates, the IUB Institutional Review Board or its designees, and (as allowed by law) state or federal agencies, specifically the Office for Human Research Protections (OHRP), etc. who may want to access your research records. </p>
  	    <h3>PAYMENT</h3>
  	    <p>For participating in this study, you will receive 0.5 credits for each 30 minutes you participate for Psychology 101, 102, or 155. Withdrawal prior to the completion of the study will result in no penalty or loss of benefits. </p>
  	    <h3>CONTACTS FOR QUESTIONS OR PROBLEMS</h3>
  	    <p>For questions about the study, contact the researcher Dr. Robert Goldstone at (812) 855-4853.  </p>
  	    <p>For questions about your rights as a research participant or to discuss problems, complaints or concerns about a research study, or to obtain information, or offer input, contact the IU Human Subjects Office at (812) 856-4242 or by email at irb@iu.edu </p>
  	    <h3>VOLUNTARY NATURE OF STUDY</h3>
  	    <p>Taking part in this study is voluntary.  You may choose not to take part or may leave the study at any time.  Leaving the study will not result in any penalty or loss of benefits to which you are entitled and you will be compensated for your time up to that point.  Your decision whether or not to participate in this study will not affect your current or future relations with the investigator(s).</p>
  	    <h3>SUBJECT'S CONSENT</h3>
  	    <p>By checking below, you acknowledge that you have read and understand the above information, the you are 18 years of age or older, and give your consent to participate in our internet-based study.</p>
  	    <p><input type="checkbox" id="consent_checkbox" />I agree to take part in this study.</p>
  	    <p>Print this page if you want a copy for your records.</p>
  	    <p>Form date: September 22, 2015</p>
  	    <h3>Protocol 0804000155 IRB Approved</h3>
  	    <button type="button" onclick="this.blur();start_experiment();">Start Experiment</button>
	</div>
	<div id="jspsych-target"></div>
    </body>
    
    <!--###########################################
	 # SCRIPTS, WHERE THE FUNCTIONS LIVE
	 ############################################-->
    <script>
     $("#jspsych-target").hide();

     /*---------------------------------
	INTRO AND EXIT
	--------------------------------*/
     function check_consent(){
  	 return document.getElementById('consent_checkbox').checked;
     }
     
     function start_experiment(){
	 if(check_consent()){
  	     $('#consent').hide();
	     $("#jspsych-target").show();
	 } else {
  	     alert("You must consent to participate in the study by checking the box next to the statement 'I agree to participate in this study.'");
  	 }
     }
     
     var timeline = [];
     var possible_networks = ['network_0','network_1','network_2'];
     var network_choice = 'network_0'; //possible_networks[Math.floor(Math.random()*possible_networks.length)];
     var image_tags = ['MISSING DATA HERE'];
     
     var welcome = {
	 type: 'html-keyboard-response',
	 stimulus: "<div class='w3-animate-opacity'><h1>Welcome</h1></div>",
	 choices: jsPsych.NO_KEYS,
	 trial_duration: 2000,
	 post_trial_gap: 100
     };

     var instructions = {
	 type: 'html-button-response',
	 stimulus: "<div class='w3-animate-opacity' style='width:65%;display:inline-block;'>\
	 <p>INTRODUCTION: <br> For this study, you will be presented with content from an online social network. You will be shown different users, the images on their page, and that user's friends.</p>\
<p>You will be able to click on a user's friends to go to that profile and view images on that profile. You will be able to indicate that you like an image by clicking on it. Images you've liked will turn green (see example below).</p>\
<p><img src='data/instructions_img.jpg' style='width:45%;height:auto;margin: 20px 20px;border-bottom: 7px solid;border-radius: 8px;'><img src='data/instructions_img.jpg' style='width:45%;height:auto;margin: 20px 20px;border-bottom: 7px solid green;border-radius: 8px;opacity: 0.75;'></p>\
	 <p>TASK: Your goal is to get a sense of the social groups in the network by visiting profiles and clicking on images that you like. In order to continue to the survey, you will need to visit at least 60 unique user profiles in the social network. The button to continue to the survey will keep track of your progress and activate when you have visited the required number of profiles.</p>\
	 <p>SURVEY: After you explore the social network, you will be given a survey about the people you just observed. You will be asked about your impressions of any groups you observed. You will also be asked for your impressions of specific users you viewed (previews of their profiles will be provided).</p>\
	 <p><i>Press the button below to start the study.</i></p></div>",
	 choices: ['Begin!'],
	 post_trial_gap: 250
     };

     var survey_instructions = {
	 type: 'html-button-response',
	 stimulus: "<div class='w3-animate-opacity' style='width:45%;display:inline-block;'>\
	 <p>You've done the first part! In this next part, you will take a survey about what you saw in the social network. You will be asked about your sense of communities in terms of characteristics like closeness, diversity, exclusivity, etc.</p>\
	 <p>You will also be provided open boxes to describe your thoughts that don't fit into the survey framework. Lastly, you'll be asked for some basic demographic information, and about your experiences with this study.</p>\
	 <p><i>Press the button below to continue.</i></p></div>",
	 choices: ["Let's go!"],
	 post_trial_gap: 250
     }
     
     var summary_page = {
	 type: 'html-button-response',
	 stimulus: "<div class='w3-animate-opacity'><p><h3>You have completed the experiment.</h3><br>\
	 Please press the button below to submit your response.</p></div",
	 choices: ['Submit'],
	 //prompt: "<div class='w3-animate-opacity'><p>Please press the button below to submit your response.</p></div"
	 post_trial_gap: 250
     }
     
     var conclusion = {
	 type: "html-keyboard-response",
	 stimulus: "<div class='w3-animate-opacity'><p><h1> Thank you for participating!</h1></p></div>"
     };

     /*---------------------------------
	BREAK POINT INFRASTRUCTURE
	--------------------------------*/
     //BREAK POINTS HANDLE ALL resumeExperiments!!
     //break_point_1 is implicitly embedded in the scosn interface

     //Transition from survey instructions to close knit questions
     var break_point_00 = {
         type: 'html-keyboard-response',
	 stimulus: "END",
     }
     
     var break_point_2 = {
	 type: 'html-keyboard-response',
	 stimulus: "",
	 choices: jsPsych.NO_KEYS,
	 trial_duration: 350,
	 on_finish: function(){
	     jsPsych.addNodeToEndOfTimeline(survey_instructions,function(){});
	     jsPsych.addNodeToEndOfTimeline(request_closeknit_animals_visited,jsPsych.resumeExperiment); 
	 }
     };

     //Transition from close knit questions to diversity questions
     var break_point_3 = {
	 type: 'html-keyboard-response',
	 stimulus: "BREAK POINT 3 (DIVERSITY STUFF NEXT)",
	 choices: jsPsych.NO_KEYS,
	 trial_duration: 1000,
	 on_finish: function(){queueDiverseCommQuestions(5);}
     };

     var break_point_4 = {
	 type: 'html-keyboard-response',
	 stimulus: "BREAK POINT 4",
	 choices: jsPsych.NO_KEYS,
	 trial_duration: 1000,
	 //on_finish: static_conclusion_appender
     };
     
     /*---------------------------------
	SCOSN INTERFACE
	--------------------------------*/

     function people_appender(){
	 jsPsych.pauseExperiment();
	 next_person = jsPsych.data.get().last(1).values()[0].next_person;
	 if (next_person!=null){
	     jsPsych.addNodeToEndOfTimeline({
		 timeline: [{
		     type: 'scosn-interface',
		     user: next_person,
		     network: network_choice,
		     on_finish: people_appender
		 }]
	     }, jsPsych.resumeExperiment);
	 } else {
	     jsPsych.addNodeToEndOfTimeline(break_point_00, jsPsych.data.displayData());
	 }
     }

     var userlist = Object.keys(friendlist);
     var choice_user = userlist[Math.floor(Math.random()*userlist.length)];
     
     var SCoSN_interface = {
	 type: "scosn-interface",
	 user: choice_user,
	 network: network_choice,
	 on_finish: people_appender                                                                         //BREAK PT1
     };

     /*---------------------------------
	SURVEY
	--------------------------------*/

     var likert_agreement_7 = ["Strongly Disagree", "Disagree", "Somewhat Disagree", "Neutral", "Somewhat Agree", "Agree", "Strongly Agree"];
     var likert_closeness_7 = ["Very Distant", "Distant", "Somewhat Distant", "Neutral", "Somewhat Close", "Close", "Very Close"];
     var likert_exlusive_7 = ["Very Exclusive", "Exclusive", "Somewhat Exlusive", "Neutral", "Somewhat Inclusive", "Inclusive", "Very Inclusive"];
     
     function getVisitedIcons(){
	 //Get the images that the user visited and show them
	 var usernames = jsPsych.data.get().values().map(a => a.user).filter(function(n){ return n != undefined });
	 let iconset = new Set();
	 for (i=0;i<usernames.length;i++){
	     iconset.add( usernames[i].substring( usernames[i].match(/_/).index+1, usernames[i].length ).toLowerCase() );
	 }
	 let iconsetarr = Array.from(iconset);
	 var icons_html = "<div class='w3-animate-opacity'>";
	 icons_html += "<p>";// class='w3-animate-opacity' style='width:45%;display:inline-block;'><p>";
	 for (i=0;i<iconsetarr.length;i++){
	     icons_html += "<img src='animal-collection/png/"+iconsetarr[i]+".png' id='"+iconsetarr[i]+"' name='animalIcons' style='width:auto;height:100px;'>";
	 }
	 icons_html += "</p>";
	 icons_html += "<p>Please select the icons above that you found to be part of close-knit communities.</p>";
	 icons_html += "</div>";
	 document.getElementById('ismasirblabla').innerHTML = icons_html;

	 let selected_images = new Set();
	 
	 //Give the images the ability to be clicked
	 var images = document.getElementsByName("animalIcons");
	 for (i=0;i<images.length;i++){
	     images[i].addEventListener("click", function() {
		 if (this.style.opacity==""){
		     this.style.opacity = '0.5';
		     selected_images.add(this.id);
		     jsPsych.data.addProperties({"selectedAnimals":Array.from(selected_images)});
		 } else if (this.style.opacity=='0.5'){
		     this.style.opacity = "";
		     selected_images.delete(this.id);
		     jsPsych.data.addProperties({"selectedAnimals":Array.from(selected_images)});
		 }
	     }, false);
	 }
     }

     function getVisitedButtons(display_values,display_text){
	 var buttons_html = "<div class='w3-animate-opacity'>";
	 buttons_html += "<p>";
	 for (i=0;i<display_values.length;i++){
	     buttons_html += "<button type='button' name='selectButtons' style='border:none;color:black;padding:15px 32px;test-align:center;margin:4px 2px;cursor:pointer;'>"+display_values[i]+"</button>";
	 }
	 buttons_html += "</p>";
	 buttons_html += "<p>"+display_text+"</p>";
	 buttons_html += "</div>";

	 document.getElementById("ismasirblabla").innerHTML = buttons_html;
	 
	 let selected_values = new Set();

	 //Let the buttons insert data
	 var buttons = document.getElementsByName("selectButtons");
	 for (i=0;i<buttons.length;i++){
	     buttons[i].addEventListener("click", function(){
		 if (!selected_values.has(this.textContent)){
		     selected_values.add(this.textContent);
		     this.style.backgroundColor = 'green';
		 } else if (selected_values.has(this.textContent)){
		     this.style.backgroundColor = '';
		     selected_values.delete(this.textContent);
		 }
	     }, false);
	 }
     }

     function comparisonPageGenerator(left_animal, left_animal_icon, right_animal, right_animal_icon){
	 //Generating display
	 var new_html = "<div class='w3-animate-opacity' id='comparison_div' style='width:45%;display:inline-block;height:"+window.innerHeight*0.40+"px;'>";

	 //Add in left animal
	 new_html += "<div id='left_animal_div' style='float: left;overflow-y: scroll;height: 55%; width: 47%; position: absolute; left: 3%; top: 5%;border: 3px solid grey;'>\
<p style='font-size:140%;float: center;'>\
<img src='animal-collection/png/"+left_animal_icon+".png' id='"+left_animal+"' name='animalIcons' style='width:auto;height:100px;'>";
	 new_html += left_animal + "<br><hr style='display: block;height: 1px; border: 0; border-top: 3px solid #bec1c6;'></p>";
	 var folder = "data/"+network_choice+"/"+left_animal+"/img/";
	 $.ajax({
	     url : folder,
	     success: function (data) {
		 $(data).find("a").attr("href", function (i, val) {
		     if( val.match(/\.(jpe?g|png|gif)$/) ) {
			 new_html += "<img src='"+ folder + val +"' style='width:45%;height:auto;margin: 20px 20px;border-radius: 8px;' id="+val+" name='imageContent'>";
		     } 
		 });
	     },
	     async: false
	 });
	 new_html += "</div>";
	 
	 //Add vertical line
	 //new_html += "<div style='border-left: 2px solid #bec1c6; height: 500px; position: absolute; left: 50%; margin-left: -3px; top: 10%;'></div>";
	 
	 //Add in right animal
	 new_html += "<div id='right_animal_div' style='float: right;overflow-y: scroll;height:55%; width: 47%; position: absolute; left: 50%; top: 5%;border: 3px solid grey;'>\
<p style='font-size:140%;float: center;'>\
<img src='animal-collection/png/"+right_animal_icon+".png' id='"+right_animal+"' name='animalIcons' style='width:auto;height:100px;'>";
	 new_html += right_animal + "<br><hr style='display: block;height: 1px; border: 0; border-top: 3px solid #bec1c6;'></p>";
	 var folder = "data/"+network_choice+"/"+right_animal+"/img/";
	 $.ajax({
	     url : folder,
	     success: function (data) {
		 $(data).find("a").attr("href", function (i, val) {
		     if( val.match(/\.(jpe?g|png|gif)$/) ) {
			 new_html += "<img src='"+ folder + val +"' style='width:45%;height:auto;margin: 20px 20px;border-radius: 8px;' id="+val+" name='imageContent'>";
		     } 
		 });
	     },
	     async: false
	 });
	 new_html += "</div>";

	 //Push the survey down
	 new_html += "<br><br><br><br><br><br><br><br><br><br><br><br><br><br><br>";
	 new_html += "</div>";
	 return new_html;
     }

     function queueCloseKnitCommQuestions(){
	 var data = jsPsych.data.get().values(); //all data value objects
	 var selected_animals = data[data.length - 1].selectedAnimals; //just list of close-knit animals selected by user
	 var new_html;
	 if (selected_animals != undefined && selected_animals.length > 0){
	     for (i=0;i<selected_animals.length;i++){
		 //Choosing two random animals (doesn't have to be previously visited)
		 animal_capitalized = selected_animals[i].charAt(0).toUpperCase() + selected_animals[i].slice(1);
		 animals_fullnames = Object.keys(friendlist).filter(a=>a.includes(animal_capitalized));
		 left_animal_fullname = animals_fullnames[Math.floor(Math.random() * animals_fullnames.length)];
		 left_animal = left_animal_fullname.substring( 0, left_animal_fullname.match(/_/).index );
		 animals_fullnames.splice(animals_fullnames.indexOf(left_animal_fullname));
		 right_animal = animals_fullnames[Math.floor(Math.random() * animals_fullnames.length)];
		 right_animal = right_animal.substring( 0, right_animal.match(/_/).index );

		 new_html = comparisonPageGenerator(left_animal,selected_animals[i],right_animal,selected_animals[i]);
		 jsPsych.addNodeToEndOfTimeline({
		     type: 'survey-likert',
		     preamble: new_html,
		     on_load: function(){ manualRecenterJS('jspsych-survey-likert-form'); },
		     questions: [{prompt: 'These two users are very similar.', labels: likert_agreement_7, required: true}]
		 },function(){});
	     }
	 }
	 jsPsych.addNodeToEndOfTimeline(break_point_3,jsPsych.resumeExperiment); 
     }

     function manualRecenterJS(divname){
	 var jsc = document.getElementById(divname);
	 jsc.style.position = 'absolute';
	 jsc.style.left = '50%';
	 jsc.style.top = '60%';
	 jsc.style.transform = 'translate(-50%,0%)';
     }
     
     function shuffleArray(array) {
	 for (let i = array.length - 1; i > 0; i--) {
             const j = Math.floor(Math.random() * (i + 1));
             [array[i], array[j]] = [array[j], array[i]]; // eslint-disable-line no-param-reassign
	 }
	 return array;
     }
     
     function queueDiverseCommQuestions(number_of_trials){
	 var data = jsPsych.data.get().values();
	 var visited_animals = data.filter(a=>a.trial_type=='scosn-interface').map(a=>a.user);
	 //Randomly create unique pairs
	 visited_animals = shuffleArray(visited_animals);
	 var animal_pairs = [];
	 while (visited_animals.length >= 2){
	     animal_pairs.push([visited_animals.pop(),visited_animals.pop()]);
	 }
	 var animal1;
	 var animal2;
	 var animal1_icon;
	 var animal2_icon;
	 if (animal_pairs.length > 0){
	     for (i=0;i<Math.min(number_of_trials,animal_pairs.length);i++){
		 animal1 = animal_pairs[i][0];
		 animal2 = animal_pairs[i][1];
		 //Get the animal's icons
		 animal1_icon = animal1.substring(animal1.match(/_/).index+1, animal1.length ).toLowerCase();
		 animal2_icon = animal2.substring(animal2.match(/_/).index+1, animal2.length ).toLowerCase();
		 animal1 = animal1.substring( 0, animal1.match(/_/).index );
		 animal2 = animal2.substring( 0, animal2.match(/_/).index );
		 
		 new_html = comparisonPageGenerator(animal1,animal1_icon,animal2,animal2_icon);
		 jsPsych.addNodeToEndOfTimeline({
		     type: 'survey-likert',
		     preamble: new_html,
		     on_load: function(){ manualRecenterJS('jspsych-survey-likert-form'); },
		     questions: [{prompt: "How similar are the images in these user profiles?", labels: likert_closeness_7,required: true}, 
      				 {prompt: "How similar are these two users?", labels: likert_exlusive_7,required: true}]
		 },function(){});
	     }
	 }
	 jsPsych.addNodeToEndOfTimeline(break_point_4,jsPsych.resumeExperiment);
     }

     var request_closeknit_animals_visited = {
	 type: 'html-button-response',
	 stimulus: "<div id='ismasirblabla'> CLOSE KNIT ICONS THING </div>",
	 choices: ['Continue'],
	 on_load: getVisitedIcons,
	 on_finish: queueCloseKnitCommQuestions
     };

     var request_diverse_animals_visited = {
	 type: 'html-button-response',
	 stimulus: "<div id='ismasirblabla'> DIVERSE ICONS THING </div>",
	 choices: ['Continue'],
	 on_load: getVisitedIcons
     };

     var group_recognition = {
	 type: 'html-button-response',
	 stimulus: "<div id='ismasirblabla'> TEST BUTTONS THING </div>",
	 choices: ['Continue'],
	 on_load: function(){
	     getVisitedButtons(image_tags,"Try to recall the content that you saw in the social network. Select the tags above that you associate with groups you saw in the social network.");
	 }
     }
     
     var difficulty_likert_page = {
	 type: 'survey-likert',
	 questions: [{prompt: "I understood what this experiment was asking of me.", labels: likert_agreement_7, required: true},
		     {prompt: "I was able to do this task easily.", labels: likert_agreement_7, required: true}]
     };

     //Content liking survey questions

     var age_ranges = ["18-21","22-25","26-30","31-35","36-40","40-50","50-60","60-70","70-80"];
     var ethnicity = ["Black or African American", "East Asian", "Hispanic or Latino", "Native American or American Indian", "Pacific Islander", "South Asian", "White", "Other"];
     var education = ["No schooling completed", "Nursery school to 8th grade", "Some high school, no diploma", "High school graduate, diploma or the equivalent (for example: GED)", "Some college credit, no degree", "Trade/technical/vocational training", "Associate degree", "Bachelor’s degree", "Master’s degree", "Professional degree", "Doctorate degree"];
     
     var demographics_ender = {
	 type: 'survey-multi-choice',
	 questions: [{prompt: "Age: ", options: age_ranges},
		     {prompt: "Ethnicity: ", options: ethnicity},
		     {prompt: "Education level (completed or pursuing): ", options: education}]
     }
     
     var open_box_ender = {
	 type: 'survey-text',
	 questions: [{prompt: "Any other thoughts about the community structures in this study:"},
		     {prompt: "Other points of confusion while participating in this study:"},
		     {prompt: "Further questions or concerns regarding this study:"}]
     }

     
     /*---------------------------------
	INITIALIZATION
	--------------------------------*/

     //Beginning stuff
     //timeline.push(welcome);
     timeline.push(instructions);
     timeline.push(SCoSN_interface);

     /*MODULAR NOTES
	scosn-interface detects a 'null' user, ends, and goes to break point 2
	break point 2 adds in the survey instructions as well as the page to generate close knit questions
	close knit questions are added, 
      */

     //End stuff
     function static_conclusion_appender(){
	 jsPsych.addNodeToEndOfTimeline(difficulty_likert_page,function(){});
	 jsPsych.addNodeToEndOfTimeline(demographics_ender,function(){});
	 jsPsych.addNodeToEndOfTimeline(open_box_ender,function(){});
	 jsPsych.addNodeToEndOfTimeline(summary_page,function(){});
	 jsPsych.addNodeToEndOfTimeline(conclusion,jsPsych.resumeExperiment);
     }

     function save_data() {
	 var data = jsPsych.data.getData();
	 $.ajax({
	     type: 'post',
	     cache: false,
	     url: 'php/write_data.php',
	     data: {
		 "table": "scosn_vw",
		 "new_data": JSON.stringify(data)
	     }
	 });
     }
     
     /* function saveData(name, data){
	var xhr = new XMLHttpRequest();
	xhr.open('POST', 'write_data.php'); // 'write_data.php' is the path to the php file described above.
	xhr.setRequestHeader('Content-Type', 'application/json');
	xhr.send(JSON.stringify({filename: name, filedata: data}));
      * } */
     
     jsPsych.init({
	 display_element: 'jspsych-target',
	 //show_progress_bar: true,
	 timeline: timeline,
	 on_finish: function(){ jsPsych.data.displayData(); }
     });
     
    </script>
    
</html>

<!-- var allnimals = ["ant-eater", "badger", "bear", "bull", "camel", "cat", "chameleon", "cock", "cow", "cow-1", "crocodile", "deer", "dog", "dolphin", "donkey", "duck", "elephant", "fish", "fox", "giraffe", "goat", "goose", "hedgehog", "hippopotamus", "horse", "kangaroo", "koala", "lion", "monkey", "moose", "mouse", "panda", "panther", "penguin", "pig", "rabbit", "racoon", "raven", "rhinoceros", "seal", "sheep", "snail", "snake", "squirrel", "tiger", "turtle", "unicorn", "vulture", "wolf", "zebra"];
-->
